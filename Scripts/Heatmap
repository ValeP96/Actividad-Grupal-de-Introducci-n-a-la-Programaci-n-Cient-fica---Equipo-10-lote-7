Vamos a crear un Heatmap para ver qué grado de correlación existe entre variables bioquímicas y los niveles de expresión de ciertos genes de una menera visual. El código de R que utilizamos es el siguiente: 

#Cargar a principio del script las librerias con las que voy a trabajar
library(ggplot2)
library(dplyr)
library(pheatmap)

Dataset_genes <- read.table(file.choose(), header = T) #para elegir la carpeta que quiero trabajar
datos_bioquimicos <- Dataset_genes %>% select("glucosa", "chol", "hdl", starts_with("AQ_")) #Los dos puntos indican desde donde hasta donde
corr_matrizdatosbio <- cor(datos_bioquimicos, method = "spearman")
corr_matrizdatosbio

#Una vez teniendo la matriz, selecciono las columnas y filass que quiero que me enfrenten unas con otras
dim(corr_matrizdatosbio) #Para saber las dimensoines de mi matriz
corr_matrix_seleccionada <- corr_matrizdatosbio[4:49, 1:3]

#Graficar la matriz
set.seed(1995)
pheatmap(corr_matrix_seleccionada, 
         main = "Heatmap",
         cluster_cols = TRUE,
         cluster_rows = TRUE,
         color = colorRampPalette(c("blue", "white", "red"))(100))


